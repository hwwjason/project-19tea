<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>组件配置</title>
    <link rel="stylesheet" href="../../frame/layui/css/layui.css">
    <link rel="stylesheet" href="../../frame/static/css/style.css">
    <link rel="stylesheet" href="../../frame/font-awesome-4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="../../frame/static/css/addProduct.css">
    <style type="text/css">
    .c-list {
        width: 520px;
        float: left;
        height: 100%;
        position: relative;
    }

    .layui-form-pane .layui-form-label {
        border: none;
    }

    .layui-tab-item {
        margin-top: 20px;
    }

    .peizhi {margin-left: 20px;
        float: left;
        width: 640px;
        position: relative;
        border: 1px solid #ddd;
        min-height: 680px;
    }

    .c-list li {
        border-bottom: 1px solid #ddd;
        line-height: 50px;
        height: 50px;
    }

    .layui-elem-quote ul {
        overflow: hidden;
    }

    .layui-elem-quote li {
        float: left;
        margin-right: 10px;
    }

    #ul2 {
        width: 420px;
    }

    .ul2-li {
        /*overflow: hidden;*/
        position: relative;
        z-index: 100;
    }

    .ul2-li:after {
        content: "";
        position: absolute;
        background: url(../../frame/static/image/right_icon.png) no-repeat;
        width: 30px;
        height: 30px;
        background-size: contain;
        top: 10px;
        right: -47px;
    }
    .ul2-btn-ul li{
        position: relative;
    }
    .ul2-btn-ul li:after {
        content: "";
        position: absolute;
        background: url(../../frame/static/image/right_icon.png) no-repeat;
        width: 30px;
        height: 30px;
        background-size: contain;
        top: 10px;
        right: -28px;
    }
    .no-after:after {
        display: none;
    }


    .ul2-li .layui-btn {
        margin-top: 10px;
    }

    .ul2-li .content-text {
        width: 420px;
        display: inline-block;
    }

    .addComponent {
        position: absolute;
        top: 0;
        right: -100px;
    }

    .url-show,
    .timeShow,
    .banner-set,
    .advertisement-set,
    .border-set,
    .product-switch-set,
    .product-set {
        display: none;
    }

    .ul2-li .layui-btn-small {
        position: absolute;
        right: 55px;
        z-index: 10000;
    }

    .ul2-li .layui-btn-small.layui-btn-danger {
        position: absolute;
        right: 0;
        z-index: 10000;
    }

    .ul2-btn-ul {
        width: 100px;
        position: absolute;
        top: 0;
        right: 0;
    }
    </style>
</head>

<body class="body">
    <div id="vueDiv" class="layui-form layui-form-pane">
        <div class="layui-elem-quote">
            <div class="layui-inline">
                <ul>
                    <li>
                        <div btnVal="Banner" class="layui-btn layuiadmin-btn-list" draggable="true" ondragstart="drag(event,0)">Banner</div>
                    </li>
                    <li>
                        <div btnVal="商品滑动栏" class="layui-btn layuiadmin-btn-list" draggable="true" ondragstart="drag(event,1)">商品滑动栏</div>
                    </li>
                    <li>
                        <div btnVal="分割线" class="layui-btn layuiadmin-btn-list" draggable="true" ondragstart="drag(event,2)">分割线</div>
                    </li>
                    <li>
                        <div btnVal="广告长图" class="layui-btn layuiadmin-btn-list" draggable="true" ondragstart="drag(event,3)">广告长图</div>
                    </li>
                    <li>
                        <div btnVal="商品通栏" class="layui-btn layuiadmin-btn-list" draggable="true" ondragstart="drag(event,4)">商品通栏</div>
                    </li>
                </ul>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label" style="background: none">方案名称</label>
                <div class="layui-input-inline">
                    <input type="text" name="title" placeholder="请输入方案名称" autocomplete="off" class="layui-input">
                </div>
            </div>
            <a class="layui-btn layuiadmin-btn-list" href="../../subpage/setup/component.html">
                <i class="layui-icon">&#xe65c;</i>返回
            </a>
            <button class="layui-btn layuiadmin-btn-list" onclick="window.location.reload()">
                <i class="fa fa-refresh"></i> 刷新
            </button>
        </div>
        <div class="c-list">
            <ul id="ul2" ondrop="drop(event)" ondragover="allowDrop(event)">
                <li class="ul2-li no-after first-content-text">
                    <text class="content-text ">请拖入组件</text>
                </li>
            </ul>
            <ul class="ul2-btn-ul">
            </ul>
        </div>
        <!-- banner设置开始 -->
        <div class="layui-tab peizhi banner-set" lay-allowClose="true" lay-filter="banner">
            <a class="layui-btn addComponent site-demo-active" lay-submit lay-filter="addComponent" data-type="tabAdd">
                <i class="fa fa-plus"></i> 添加
            </a>
            <ul class="layui-tab-title">
                <li v-for="(bitem1,index1) in bannerObj" :class="index1==0?'layui-this':''" :index="index1" :thisid="bitem1.id">{{bitem1.name}}</li>
            </ul>
            <div class="layui-tab-content">
                <div v-for="(bitem,index) in bannerObj" class="layui-tab-item  banner-content" :class="[index==0?'layui-show':'','bannerTab'+index]">
                    <div class="layui-form-item">
                        <form id="uploadForm" enctype="multipart/form-data" method="post" action="">
                            <label class="layui-form-label">图片</label>
                            <div class="layui-input-inline">
                                <div class="addImg">
                                    <i class="fa fa-plus"></i>
                                </div>
                                <input type="hidden" name="" class="img-hidden" >
                                <input type="file" class="input-file" name="file" onchange="preview(this)">
                            </div>
                        </form>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">跳转地址</label>
                        <div class="layui-input-block">
                            <input type="radio" lay-filter="urlType" v-model="bitem.jumpType" class="bannerurlType" :name="'bannerurlType'+index" value="0" title="频道">
                            <input type="radio" lay-filter="urlType" v-model="bitem.jumpType" class="bannerurlType" :name="'bannerurlType'+index" value="1" title="商品">
                            <input type="radio" lay-filter="urlType" v-model="bitem.jumpType" class="bannerurlType" :name="'bannerurlType'+index" value="2" title="链接">
                        </div>
                    </div>
                    <div class="product-show">
                        <div class="layui-form-item">
                            <label class="layui-form-label">商品编号</label>
                            <div class="layui-input-inline">
                                <input name="121" class="layui-input productCode" :value="bitem.productCode" placeholder="请输入商品编号搜索">
                            </div>
                            <div class="layui-input-inline">
                                <button class="layui-btn layuiadmin-btn-list">
                                    匹配
                                </button>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <div class="layui-inline">
                                <label class="layui-form-label">商品标题</label>
                                <div class="layui-input-inline">
                                    <input name="" class="layui-input productName" :value="bitem.productName">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="url-show">
                        <div class="layui-form-item">
                            <div class="layui-inline">
                                <label class="layui-form-label"></label>
                                <div class="layui-input-inline">
                                    <input name="" class="layui-input jumpUrl" :value="bitem.jumpUrl">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-inline">
                            <label class="layui-form-label">排序</label>
                            <div class="layui-input-inline">
                                <input name="" class="layui-input orders" :value="bitem.orders">
                            </div>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">时效</label>
                        <div class="layui-input-block">
                            <input type="radio" lay-filter="timeType" class="timeType" v-model="bitem.timeType" :name="'bannertimeType'+index" value="0" title="永久">
                            <input type="radio" lay-filter="timeType" class="timeType" v-model="bitem.timeType" :name="'bannertimeType'+index" value="1" title="时间配置">
                        </div>
                    </div>
                    <div class="timeShow">
                        <div class="layui-form-item">
                            <label class="layui-form-label">开始时间</label>
                            <div class="layui-input-inline">
                                <input type="text" class="layui-input dateBegin" placeholder="yyyy-MM-dd" :value="bitem.startTime">
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">结束时间</label>
                            <div class="layui-input-inline">
                                <input type="text" class="layui-input dateEnd" placeholder="yyyy-MM-dd" :value="bitem.endTime">
                            </div>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-inline">
                            <label class="layui-form-label"></label>
                            <div class="layui-input-inline">
                                <button class="layui-btn" :index="index" :thisid="bitem.id" onclick="bannerSave(this)">保存</button>
                                <button class="layui-btn" onclick="closeTab(this)">关闭</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- banner设置结束 -->
        <!-- 广告长图设置开始 -->
        <div class="peizhi advertisement-set" lay-filter="advertisement">
            <div class="layui-tab-item layui-show">
                <div class="layui-form-item">
                    <form id="uploadForm" enctype="multipart/form-data" method="post" action="">
                        <label class="layui-form-label">图片</label>
                        <div class="layui-input-inline">
                            <div class="addImg">
                                <i class="fa fa-plus"></i>
                            </div>
                            <input type="hidden" name="" class="img-hidden" >
                            <input type="file" :value="advertisementVmObj.file" class="input-file" name="file" onchange="preview(this)">
                        </div>
                    </form>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">跳转地址</label>
                    <div class="layui-input-block">
                        <input type="radio" lay-filter="urlType" class="bannerurlType" v-model="advertisementVmObj.jumpType" name="advertisementurlType" value="0" title="频道">
                        <input type="radio" lay-filter="urlType" class="bannerurlType" v-model="advertisementVmObj.jumpType" name="advertisementurlType" value="1" title="商品">
                        <input type="radio" lay-filter="urlType" class="bannerurlType" v-model="advertisementVmObj.jumpType" name="advertisementurlType" value="2" title="链接">
                    </div>
                </div>
                <div class="product-show">
                    <div class="layui-form-item">
                        <label class="layui-form-label">商品编号</label>
                        <div class="layui-input-inline">
                            <input class="layui-input productCode" :value="advertisementVmObj.productCode" placeholder="请输入商品编号搜索">
                        </div>
                        <div class="layui-input-inline">
                            <button class="layui-btn layuiadmin-btn-list">
                                匹配
                            </button>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-inline">
                            <label class="layui-form-label">商品标题</label>
                            <div class="layui-input-inline">
                                <input name="productName" class="layui-input productName" :value="advertisementVmObj.productName">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="url-show">
                    <div class="layui-form-item">
                        <div class="layui-inline">
                            <label class="layui-form-label"></label>
                            <div class="layui-input-inline">
                                <input name="" class="layui-input jumpUrl" :value="advertisementVmObj.jumpUrl">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">时效</label>
                    <div class="layui-input-block">
                        <input type="radio" lay-filter="timeType" class="timeType" v-model="advertisementVmObj.timeType" name="advertisementtimeType" value="0" title="永久">
                        <input type="radio" lay-filter="timeType" class="timeType" v-model="advertisementVmObj.timeType" name="advertisementtimeType" value="1" title="时间配置">
                    </div>
                </div>
                <div class="timeShow">
                    <div class="layui-form-item">
                        <label class="layui-form-label">开始时间</label>
                        <div class="layui-input-inline">
                            <input type="text" class="layui-input dateBegin" :value="advertisementVmObj.startTime" placeholder="yyyy-MM-dd">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">结束时间</label>
                        <div class="layui-input-inline">
                            <input type="text" class="layui-input dateEnd" :value="advertisementVmObj.endTime" placeholder="yyyy-MM-dd">
                        </div>
                    </div>
                </div>
                <div class="layui-form-item">
                    <div class="layui-inline">
                        <label class="layui-form-label"></label>
                        <div class="layui-input-inline">
                            <button class="layui-btn" :thisid="advertisementVmObj.id" onclick="advertisementSave(this)">保存</button>
                            <button class="layui-btn" onclick="closeTab(this)">关闭</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- 广告长图设置结束 -->
        <!-- 分割线设置开始 -->
        <div class="peizhi border-set">
            <div class="layui-tab-item layui-show">
                <div class="layui-form-item">
                    <label class="layui-form-label">分割线粗细</label>
                    <div class="layui-input-inline">
                        <input class="layui-input border-px" name="username">
                    </div>
                    <div class="layui-input-inline" style="line-height: 38px">px</div>
                </div>
                <div class="layui-form-item">
                    <div class="layui-inline">
                        <label class="layui-form-label"></label>
                        <div class="layui-input-inline">
                            <button class="layui-btn" onclick="borderSave(this)">保存</button>
                            <button class="layui-btn" onclick="closeTab(this)">关闭</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- 分割线设置结束 -->
        <!-- 商品通栏设置开始 -->
        <div class="layui-tab peizhi product-set" lay-allowClose="true" lay-filter="product">
            <a class="layui-btn addComponent site-product-active" lay-submit lay-filter="productComponent" data-type="productAdd">
                <i class="fa fa-plus"></i> 添加
            </a>
            <ul class="layui-tab-title">
                <li v-for="(bitem1,index1) in productVmObj" :class="index1==0?'layui-this':''" :index="index1" :thisid="bitem1.id">{{bitem1.name}}</li>
            </ul>
            <div class="layui-tab-content">
                <div class="layui-tab-item product-content" v-for="(bitem,index) in productVmObj" :class="[index==0?'layui-show':'','productTab'+index]">
                    <div class="product-show">
                        <div class="layui-form-item">
                            <label class="layui-form-label">商品编号</label>
                            <div class="layui-input-inline">
                                <input name="productCode" :value="bitem.productCode" class="layui-input productCode" placeholder="请输入商品编号搜索">
                            </div>
                            <div class="layui-input-inline">
                                <button class="layui-btn layuiadmin-btn-list">
                                    匹配
                                </button>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <div class="layui-inline">
                                <label class="layui-form-label">商品名称</label>
                                <div class="layui-input-inline">
                                    <input name="productName" class="layui-input productName" :value="bitem.productName">
                                </div>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <div class="layui-inline">
                                <label class="layui-form-label">商品价格</label>
                                <div class="layui-input-inline">
                                    <input name="productPrice" class="layui-input productPrice" :value="bitem.productPrice">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-inline">
                            <label class="layui-form-label">标签1</label>
                            <div class="layui-input-inline">
                                <input name="tagFirst" class="layui-input tagFirst" :value="bitem.tagFirst">
                            </div>
                        </div>
                        <div class="layui-inline">
                            <label class="layui-form-label">标签2</label>
                            <div class="layui-input-inline">
                                <input name="tagSecond" class="layui-input tagSecond" :value="bitem.tagSecond">
                            </div>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-inline">
                            <label class="layui-form-label">排序</label>
                            <div class="layui-input-inline">
                                <input name="orders" class="layui-input orders" :value="bitem.orders">
                            </div>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">时效</label>
                        <div class="layui-input-block">
                            <input type="radio" lay-filter="timeType" class="timeType" name="producttimeType" v-model="bitem.timeType" :name="'bannertimeType'+index" value="0" title="永久">
                            <input type="radio" lay-filter="timeType" class="timeType" name="producttimeType" v-model="bitem.timeType" :name="'bannertimeType'+index" value="1" title="时间配置">
                        </div>
                    </div>
                    <div class="timeShow">
                        <div class="layui-form-item">
                            <label class="layui-form-label">开始时间</label>
                            <div class="layui-input-inline">
                                <input type="text" class="layui-input dateBegin" placeholder="yyyy-MM-dd" :value="bitem.startTime">
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">结束时间</label>
                            <div class="layui-input-inline">
                                <input type="text" class="layui-input dateEnd" placeholder="yyyy-MM-dd" :value="bitem.endTime">
                            </div>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-inline">
                            <label class="layui-form-label"></label>
                            <div class="layui-input-inline">
                                <button class="layui-btn" :index="index" :thisid="bitem.id" onclick="productSave(this)">保存</button>
                                <button class="layui-btn" onclick="closeTab(this)">关闭</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- 商品通栏设置结束 -->
        <!-- 商品滑动栏设置开始 -->
        <div class="layui-tab peizhi product-switch-set" lay-allowClose="true" lay-filter="product-switch">
            <a class="layui-btn addComponent site-product-switch-active" lay-submit lay-filter="productSwitchComponent" data-type="ppAdd" onclick="ppAdd()">
                <i class="fa fa-plus"></i> 添加
            </a>
            <ul class="layui-tab-title">
                <li v-for="(bitem1,index1) in productVmObj" :class="index1==0?'layui-this':''" :index="index1" :thisid="bitem1.id">{{bitem1.name}}</li>
            </ul>
            <div class="layui-tab-content">
                <div class="layui-tab-item product-switch-content" v-for="(bitem,index) in productVmObj" :class="[index==0?'layui-show':'','productSwitchTab'+index]">
                    <div class="product-show">
                        <div class="layui-form-item">
                            <label class="layui-form-label">商品编号</label>
                            <div class="layui-input-inline">
                                <input name="productCode" :value="bitem.productCode" class="layui-input productCode" placeholder="请输入商品编号搜索">
                            </div>
                            <div class="layui-input-inline">
                                <button class="layui-btn layuiadmin-btn-list">
                                    匹配
                                </button>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <div class="layui-inline">
                                <label class="layui-form-label">商品名称</label>
                                <div class="layui-input-inline">
                                    <input name="productName" class="layui-input productName" :value="bitem.productName">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-inline">
                            <label class="layui-form-label">商品价格</label>
                            <div class="layui-input-inline">
                                <input name="productPrice" class="layui-input productPrice" :value="bitem.productPrice">
                            </div>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-inline">
                            <label class="layui-form-label">排序</label>
                            <div class="layui-input-inline">
                                <input name="orders" class="layui-input orders" :value="bitem.orders">
                            </div>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">时效</label>
                        <div class="layui-input-block">
                            <input type="radio" lay-filter="timeType" class="timeType productSwitchTabRadio" name="producttimeType" v-model="bitem.timeType" :name="'bannertimeType'+index" value="0" title="永久">
                            <input type="radio" lay-filter="timeType" class="timeType productSwitchTabRadio" name="producttimeType" v-model="bitem.timeType" :name="'bannertimeType'+index" value="1" title="时间配置">
                        </div>
                    </div>
                    <div class="timeShow">
                        <div class="layui-form-item">
                            <label class="layui-form-label">开始时间</label>
                            <div class="layui-input-inline">
                                <input type="text" class="layui-input dateBegin" placeholder="yyyy-MM-dd" :value="bitem.startTime">
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">结束时间</label>
                            <div class="layui-input-inline">
                                <input type="text" class="layui-input dateEnd" placeholder="yyyy-MM-dd" :value="bitem.endTime">
                            </div>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-inline">
                            <label class="layui-form-label"></label>
                            <div class="layui-input-inline">
                                <button class="layui-btn" :index="index" :thisid="bitem.id" onclick="productSwitchSave(this)">保存</button>
                                <button class="layui-btn" onclick="closeTab(this)">关闭</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- 商品滑动栏设置结束 -->
    </div>
    <script type="text/javascript" src="../../frame/static/js/jquery-2.1.1.min.js"></script>
    <script type="text/javascript" src="../../frame/layui/layui.js"></script>
    <script type="text/javascript" src="../../frame/dragsort/jquery.dragsort.js"></script>
    <script type="text/javascript" src="../../frame/static/js/vue.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="../../frame/static/js/public.js"></script>
    <script type="text/javascript" charset="utf-8" src="../../frame/static/js/jquery.form.js"></script>
    <script type="text/javascript">
    var contentid = GetRequest().id;
    var initObj = "";

    function initList() {
        $.post(baseURL + "content/findByContentidAndIsContainSecond", { contentid: contentid, isContainSecondLevel: false }, function(res) {
            if (res.status == 1) {
                if (res.data.contentFormDTOS.length == 0) {
                    $(".first-content-text").show();
                } else {
                    initObj = res.data;
                    var html = "",
                        html2 = "",
                        className = "",
                        resdata = res.data.contentFormDTOS;

                    for (var i = 0; i < resdata.length; i++) {
                        if (resdata[i].formType == "0") {
                            className = "'banner-set'";
                        }
                        if (resdata[i].formType == '1') {
                            className = "'product-switch-set '";
                        }
                        if (resdata[i].formType == '2') {
                            className = "'border-set'";
                        }
                        if (resdata[i].formType == '3') {
                            className = "'advertisement-set'";
                        }
                        if (resdata[i].formType == '4') {
                            className = "'product-set'";
                        }
                        var theid = resdata[i].id;
                        var thetype = resdata[i].formType;
                        var widthpx = resdata[i].width;
                        // html += '<li class="ul2-li no-after ul2-li-no-first" theid="' + theid + '" thetype="' + thetype + '"><text class="content-text" ondblclick="modifyName(this)">' + resdata[i].name + '</text><text class="layui-btn layui-btn-small border-set-li" widthpx=' + widthpx + ' onclick="set(this)">配置</text><text class="layui-btn layui-btn-small layui-btn-danger" theid="' + theid + '" thetype="' + thetype + '"  onclick="deleteComponent(this)">删除</text></li>'
                        html += '<li class="ul2-li no-after ul2-li-no-first" theid="' + theid + '" thetype="' + thetype + '"><text class="content-text" ondblclick="modifyName(this)">' + resdata[i].name + '</text></li>'
                        html2 += '<li class="no-after"><text class="layui-btn layui-btn-small border-set-li" widthpx=' + widthpx + ' onclick="set(this)">配置</text><text class="layui-btn layui-btn-small layui-btn-danger" theid="' + theid + '" thetype="' + thetype + '"  onclick="deleteComponent(this)">删除</text></li>';
                    }
                    $("#ul2").append(html);
                    $(".ul2-btn-ul").append(html2);
                    btnSort()
                    $(".first-content-text").hide();
                }
            } else {
                layer.msg(res.message)
            }

        }, "json")
    }
    $(function() {
        //拖动排序
        $(".c-list #ul2").dragsort({
            dragEnd: function(e) {
                var arrstring = [];
                $(".ul2-li").each(function(i, e) {
                    var theidval = $(this).attr("theid");
                    if (theidval != undefined) {
                        arrstring.push(theidval);
                    }
                })
                arrstring = arrstring.toString();
                var obj2 = {
                    id: contentid,
                    orders: arrstring
                }
                $.ajax({
                    url: baseURL + "content/createOrUpdate",
                    type: 'POST',
                    dataType: 'json',
                    contentType: "application/json;charset=UTF-8",
                    data: JSON.stringify(obj2),
                }).done(function(res) {
                    if (res.status == "1") {
                        btnSort()
                    }
                }).fail(function() {

                })
            }
        });
        initList();
    })
    var layer = "";
    var form = "",
        element = "",
        laydate = "";
    layui.use(['element', 'layer', 'form', 'laydate'], function() {
        form = layui.form;
        layer = layui.layer;
        laydate = layui.laydate;
        var $ = layui.jquery;
        element = layui.element; //Tab的切换功能，切换事件监听等，需要依赖element模块

        //触发事件 添加
        var bannerName = "";
        var active = {
            tabAdd: function(e) {
                bannerVm.bannerObj.push({ name: "banner2", timeType: 0, jumpType: 0 });
                setTimeout(function() {
                    element.init();
                    form.render();
                }, 0)
            }
        };
        element.on('tab(banner)', function(data) {
            if (bannerVm.bannerObj[data.index].timeType == 1) {
                $(".bannerTab" + data.index).find('.timeShow').show();
            } else {
                $(".bannerTab" + data.index).find('.timeShow').hide();
            }
            if (bannerVm.bannerObj[data.index].jumpType == 1) {
                $(".bannerTab" + data.index).find('.product-show').show();
                $(".bannerTab" + data.index).find('.url-show').hide();
            } else {
                $(".bannerTab" + data.index).find('.product-show').hide();
                $(".bannerTab" + data.index).find('.url-show').show();
            }
        });
        element.on('tab(product-switch)', function(data) {
            if (productSwitchVm.productVmObj[data.index].timeType == 1) {
                $(".productSwitchTab" + data.index).find('.timeShow').show();
            } else {
                $(".productSwitchTab" + data.index).find('.timeShow').hide();
            }
        });
        //商品通栏的tab新增
        var productName = "";
        var productHtml = $(".product-content").html();
        var productactive = {
            productAdd: function(e) {
                //新增一个Tab项
                productVm.productVmObj.push({ name: "商品2", timeType: 0 });
                setTimeout(function() {
                    element.init();
                    form.render();
                }, 0)
            }
        };
        //右侧tab删除的请求
        $(".layui-tab").on("click", function(e) {
            if ($(e.target).is(".layui-tab-close")) {
                var thisid = $(e.target).parent().attr("thisid");
                var data = { ids: thisid }
                var thetype = "";
                // layer.confirm('您是确定删除吗？', {
                //   btn: ['确定','取消'] //按钮
                // }, function(){

                // }, function(){

                // });
                var url = baseURL + "contentForm/deleteByIds";
                $.post(url, data, function(res) {
                    if (res.status == "1") {

                    }
                }, "json");
            }
        })

        $('.site-demo-active').on('click', function() {
            var length = $(".banner-set .layui-tab-title li").length + 1;
            bannerName = "banner" + length;
            var othis = $(this),
                type = othis.data('type');
            active[type] ? active[type].call(this, othis) : '';
        });
        $('.site-product-active').on('click', function() {
            var length = $(".product-set .layui-tab-title li").length + 1;
            productName = "商品" + length;
            var othis = $(this),
                type = othis.data('type');
            productactive[type] ? productactive[type].call(this, othis) : '';
        });
        // 跳转地址类型切换
        form.on('radio(urlType)', function(data) {
            if (data.value == "1") {
                $(".product-show").show();
                $(".url-show").hide();
            } else {
                $(".product-show").hide();
                $(".url-show").show();
            }
        });
        // 时效切换
        form.on('radio(timeType)', function(data) {
            if (data.value == "0") {
                $(".timeShow").hide();
            } else {
                $(".timeShow").show();
            }
        });
        //时间范围
        // laydate.render({
        //     elem: '.dateBegin',
        //     type: 'datetime',
        //     done: function(value, date, endDate) {

        //     }
        // });
        // laydate.render({
        //     elem: '.dateEnd',
        //     type: 'datetime',
        //     done: function(value, date, endDate) {

        //     }
        // });
    });

    function ppAdd(argument) {
        // body...
        productSwitchVm.productVmObj.push({ name: "商品2", timeType: 0 });
        setTimeout(function() {
            element.init();
            form.render();
        }, 0)
    }

    function allowDrop(ev) {
        ev.preventDefault();
    }

    function drag(ev, type) {
        var btnVal = ev.target.getAttribute("btnVal");
        ev.dataTransfer.setData("Text", btnVal);
        ev.dataTransfer.setData("type", type);
    }

    function drop(ev) {
        ev.stopPropagation();
        ev.preventDefault();
        var data = ev.dataTransfer.getData("Text");
        var type = ev.dataTransfer.getData("type");
        var className = "";
        var dataArr = ["Banner", "广告长图", "分割线", "商品通栏", "商品滑动栏"];
        if (dataArr.indexOf(data) == -1) {
            return false;
        }
        newComponent(data, ev.target, type);
    }
    //双击修改名称
    function modifyName(argument) {
        var that = $(argument);
        layer.prompt({ title: '输入组件名称' }, function(pass, index) {
            that.text(pass);
            layer.close(index);
        });
    }
    //图片预览
    function preview(obj) {
        var formData = new FormData($("#uploadForm")[0]);
        $("#uploadForm").ajaxSubmit({
            url: baseURL + "bak/image/uploadImage",
            type: "post",
            success: function(res) {
                if (res.status == 1) {
                    var str = "";
                    str += "<img class='preview-img' src='" + res.path + "'/>";
                    str += '<span class="del-span" onclick="delimg(this)"><i class="layui-icon layui-icon-close-fill">&#x1007;</i></span>';
                    $(obj).parent().append(str);
                    $(obj).siblings('.img-hidden').val(res.path);
                } else {
                    layer.msg(res.message)
                }
            }
        })
    }

    function delimg(obj) {
        $(obj).siblings(".preview-img").remove();
        $(obj).siblings(".input-file").val("");
        $(obj).siblings(".img-hidden").val("");
        $(obj).remove();
    }
    // 创建banner的vue对象
    var bannerVm = new Vue({
        el: ".banner-set",
        data: {
            bannerObj: [{}]
        }
    })
    // 创建商品通栏的vue对象
    var productVm = new Vue({
        el: ".product-set",
        data: {
            productVmObj: [{}]
        }
    })
    // 创建商品滑动通栏的vue对象
    var productSwitchVm = new Vue({
        el: ".product-switch-set",
        data: {
            productVmObj: [{}]
        }
    })
    //广告长图的vue对象
    var advertisementVm = new Vue({
        el: ".advertisement-set",
        data: {
            advertisementVmObj: {}
        }
    })

    function set(obj) {
        // var type = $(obj).parent(".ul2-li").attr("thetype");
        // var id = $(obj).parent(".ul2-li").attr("theid");
        var type = $(obj).attr("thetype");
        var id = $(obj).attr("theid");
        var className = $(obj).attr("className");
        var leftName = $(obj).attr("dataName");
        if (type == 2) {
            //分割线设置
            var widthpx = $(obj).attr("widthpx");
            if (widthpx != "undefined") {
                $(".border-set").find(".border-px").val(widthpx);
            } else {
                $(".border-set").find(".border-px").val("");
            }
        }
        if (type == 3) {
            //广告长图
            console.log(initObj)
            console.log(array)
            if (initObj == "") {

            } else {
                var array = initObj.contentFormDTOS;
                for (var i = 0; i < array.length; i++) {
                    if (array[i].id == id) {
                        advertisementVm.advertisementVmObj = array[i];
                        if (array[i].timeType == 1) {
                            $(".advertisement-set").find('.timeShow').show();
                        } else {
                            $(".advertisement-set").find('.timeShow').hide();
                        }
                        if (array[i].jumpType == 1) {
                            $(".advertisement-set").find('.product-show').show();
                            $(".advertisement-set").find('.url-show').hide();
                        } else {
                            $(".advertisement-set").find('.product-show').hide();
                            $(".advertisement-set").find('.url-show').show();
                        }
                        setTimeout(function() {
                            form.render();
                            dateInit();
                        }, 0)
                    }
                }
            }

        }
        if (type == 0) {
            //banner设置
            $.post(baseURL + "contentForm/findByParentid", { parentid: id }, function(res) {
                if (res.status == "1") {
                    if (res.data.length != 0) {
                        if (type == 0) {
                            bannerVm.bannerObj = res.data;
                            for (var i = 0; i < bannerVm.bannerObj.length; i++) {
                                if (bannerVm.bannerObj[i].timeType == "1") {
                                    $(".bannerTab" + i).find('.timeShow').show();
                                } else {
                                    $(".bannerTab" + i).find('.timeShow').hide();
                                }
                            }
                        }
                    } else {
                        bannerVm.bannerObj = [{
                            name: "banner1",
                            timeType: 0,
                            jumpType: 1
                        }]
                    }
                    setTimeout(function() {
                        element.init();
                        form.render();
                        dateInit();
                    }, 0)
                } else {
                    layer.msg(res.message)
                }
            }, "json")
        }
        if (type == 4) {
            //商品通栏设置
            $.post(baseURL + "contentForm/findByParentid", { parentid: id }, function(res) {
                if (res.status == "1") {

                    if (res.data.length != 0) {
                        productVm.productVmObj = res.data;
                        for (var i = 0; i < productVm.productVmObj.length; i++) {
                            if (productVm.productVmObj[i].timeType == "1") {
                                $(".productTab" + i).find('.timeShow').show();
                            } else {
                                $(".productTab" + i).find('.timeShow').hide();
                            }
                        }
                    } else {
                        productVm.productVmObj = [{
                            name: "商品通栏",
                            timeType: 0,
                            jumpType: 1
                        }]
                    }
                    setTimeout(function() {
                        element.init();
                        form.render();
                        dateInit();
                    }, 0)
                } else {
                    layer.msg(res.message)
                }
            }, "json")
        }
        if (type == 1) {
            //商品滑动通栏设置
            $.post(baseURL + "contentForm/findByParentid", { parentid: id }, function(res) {
                if (res.status == "1") {
                    if (res.data.length != 0) {
                        productSwitchVm.productVmObj = res.data;
                        for (var i = 0; i < productSwitchVm.productVmObj.length; i++) {
                            if (productSwitchVm.productVmObj[i].timeType == "1") {
                                $(".productSwitchTab" + i).find('.timeShow').show();
                            } else {
                                $(".productSwitchTab" + i).find('.timeShow').hide();
                            }
                        }
                    } else {
                        productSwitchVm.productVmObj = [{
                            name: "商品滑动通栏",
                            timeType: 0,
                            jumpType: 1
                        }]
                    }
                    setTimeout(function() {
                        element.init();
                        form.render();
                        dateInit();
                    }, 0)
                } else {
                    layer.msg(res.message)
                }
            }, "json")
        }
        $(obj).parent("li").removeClass("no-after").siblings("li").addClass('no-after');
        $(".peizhi").hide();
        $("." + className).show().attr({ thetype: type, theid: id, leftName: leftName });
    }
    var arr = [];
    var allArr = [];

    function newComponent(val, dom, type) {
        var url = baseURL + "contentForm/createOrUpdate";
        var obj = {
            name: val,
            contentid: contentid,
            level: 1,
            formType: type
        };
        $.ajax({
            url: url,
            type: 'POST',
            dataType: 'json',
            contentType: "application/json;charset=UTF-8",
            data: JSON.stringify(obj),
        }).done(function(res) {
            if (res.status == "1") {
                var data = "";
                if (type == "0") {
                    className = "'banner-set'";
                    data = "Banner";
                }
                if (type == "1") {
                    className = "'product-switch-set'";
                    data = "商品滑动栏";
                }
                if (type == "2") {
                    className = "'border-set'";
                    data = "分割线";
                }
                if (type == "3") {
                    className = "'advertisement-set'";
                    data = "广告长图";
                }
                if (type == "4") {
                    className = "'product-set'";
                    data = "商品通栏";
                }
                var theid = res.data.id;
                var thetype = res.data.formType;
                var widthpx = res.data.width;
                // var html = '<li class="ul2-li no-after ul2-li-no-first" thetype="' + thetype + '" theid="' + theid + '"><text class="content-text" ondblclick="modifyName(this)">' + data + '</text><text class="layui-btn layui-btn-small border-set-li" widthpx=' + widthpx + ' onclick="set(this)">配置</text><text class="layui-btn layui-btn-small layui-btn-danger" thetype="' + thetype + '" theid="' + theid + '"  onclick="deleteComponent(this)">删除</text></li>'
                var html = '<li class="ul2-li no-after ul2-li-no-first" thetype="' + thetype + '" theid="' + theid + '"><text class="content-text" ondblclick="modifyName(this)">' + data + '</text></li>'
                var dropclass = dom.getAttribute("class");
                html2 = '<li class="no-after"><text class="layui-btn layui-btn-small border-set-li" widthpx=' + widthpx + ' onclick="set(this)">配置</text><text class="layui-btn layui-btn-small layui-btn-danger" theid="' + theid + '" thetype="' + thetype + '"  onclick="deleteComponent(this)">删除</text></li>';

                if (dropclass != "ul2-li") {
                    $(".ul2-btn-ul").append(html2);
                    $(dom).parent(".ul2-li").after(html);
                    $(".first-content-text").hide();
                    btnSort()
                } else {
                    $(".ul2-btn-ul").append(html2);
                    $(dom).after(html);
                    $(".first-content-text").hide();
                    btnSort()
                }
                var arrstring = [];
                $(".ul2-li").each(function(i, e) {
                    var theidval = $(this).attr("theid");
                    if (theidval != undefined) {
                        arrstring.push(theidval);
                    }
                })
                arrstring = arrstring.toString();
                var obj2 = {
                    id: contentid,
                    orders: arrstring
                };
                updateParentContent(obj2, dom, type);
            } else {
                layer.msg(res.message)
            }
        }).fail(function() {
            console.log("error");
        })
    }

    function updateParentContent(obj2, dom, type) {
        $.ajax({
            url: baseURL + "content/createOrUpdate",
            type: 'POST',
            dataType: 'json',
            contentType: "application/json;charset=UTF-8",
            data: JSON.stringify(obj2),
        }).done(function(res) {
            if (res.status == "1") {

            }
        }).fail(function() {

        })
    }

    function deleteComponent(dom) {
        var thetype = "";
        var url = baseURL + "contentForm/deleteByIds";
        thetype = $(dom).attr("thetype");

        var data = { ids: $(dom).attr("theid") }
        layer.confirm('您是确定删除吗？', {
            btn: ['确定', '取消'] //按钮
        }, function(index) {
            $.post(url, data, function(res) {
                if (res.status == "1") {
                    $(".ul2-btn-ul li").eq($(".ul2-btn-ul li").length - 1).remove();
                    $(dom).parent(".ul2-li").remove();
                    if ($(".ul2-li").length == 1) {
                        $(".first-content-text").show();
                    }
                    if (thetype == "0") {
                        $(".banner-set").hide();
                    }
                    if (thetype == "1") {
                        $(".product-switch-set").hide();
                    }
                    if (thetype == "2") {
                        $(".border-set").hide();
                    }
                    if (thetype == "3") {
                        $(".advertisement-set").hide();
                    }
                    if (thetype == "4") {
                        $(".product-set").hide();
                    }
                    layer.close(index);
                } else {
                    layer.msg(res.message)
                }
            }, "json");
        }, function() {

        });

    }

    // 右侧banner明细新建和编辑
    function bannerSave(dom) {
        var that = $(dom);
        var index = $(dom).attr("index");
        var thisid = $(dom).attr("thisid");
        var parentDom = $(dom).parents(".banner-content");
        var bvmindex = bannerVm.bannerObj[index];
        var dataObj = {};
        if (index && thisid) {
            //有索引和ID代表着更新
            bvmindex.id = thisid;
            bvmindex.name = "banner1";
            bvmindex.contentid = contentid;
            bvmindex.level = 2;
            bvmindex.formType = 0;
            bvmindex.parentid = $(dom).parents(".banner-set").attr("theid");
            bvmindex.imgurl = parentDom.find('.img-hidden').val();
            bvmindex.productCode = parentDom.find('.productCode').val();
            bvmindex.productName = parentDom.find('.productName').val();
            bvmindex.orders = parentDom.find('.orders').val();
            bvmindex.startTime = parentDom.find('.dateBegin').val();
            bvmindex.endTime = parentDom.find('.dateEnd').val();
            bvmindex.jumpUrl = parentDom.find('.jumpUrl').val();
            bvmindex.timeType = parentDom.find('.timeType:checked').val();
            bvmindex.jumpType = parentDom.find('.bannerurlType:checked').val();
            dataObj = bvmindex;
        } else {
            //新建
            var obj = {};
            obj.name = "banner1";
            obj.level = 2;
            obj.formType = 0;
            obj.contentid = contentid;
            obj.parentid = $(dom).parents(".banner-set").attr("theid");
            obj.imgurl = parentDom.find('.img-hidden').val();
            obj.productCode = parentDom.find('.productCode').val();
            obj.productName = parentDom.find('.productName').val();
            obj.orders = parentDom.find('.orders').val();
            obj.startTime = parentDom.find('.dateBegin').val();
            obj.endTime = parentDom.find('.dateEnd').val();
            obj.jumpUrl = parentDom.find('.jumpUrl').val();
            obj.timeType = parentDom.find('.timeType:checked').val();
            obj.jumpType = parentDom.find('.bannerurlType:checked').val();
            dataObj = obj
        }
        $.ajax({
            url: baseURL + "contentForm/createOrUpdate",
            type: 'POST',
            dataType: 'json',
            contentType: "application/json;charset=UTF-8",
            data: JSON.stringify(dataObj),
        }).done(function(res) {
            if (res.status == "1") {
                layer.msg("保存成功");
                closeTab(dom);
            } else {
                layer.msg(res.message)
            }
        }).fail(function() {
            console.log("error");
        })
    }
    //滑动商品栏
    function productSwitchSave(dom) {
        var that = $(dom);
        var index = $(dom).attr("index");
        var thisid = $(dom).attr("thisid");
        var parentDom = $(dom).parents(".product-switch-content");
        var leftName = parentDom.parents(".product-switch-set").attr("leftName");
        var bvmindex = productVm.productVmObj[index];
        var dataObj = {};
        if (index && thisid) {
            //有索引和ID代表着更新
            bvmindex.id = thisid;
            bvmindex.name = leftName;
            bvmindex.level = 2;
            bvmindex.formType = 1;
            bvmindex.contentid = contentid;
            bvmindex.parentid = $(dom).parents(".product-switch-set").attr("theid");
            bvmindex.productCode = parentDom.find('.productCode').val();
            bvmindex.productName = parentDom.find('.productName').val();
            bvmindex.orders = parentDom.find('.orders').val();
            bvmindex.startTime = parentDom.find('.dateBegin').val();
            bvmindex.endTime = parentDom.find('.dateEnd').val();
            bvmindex.timeType = parentDom.find('.timeType:checked').val();
            bvmindex.tagFirst = parentDom.find('.tagFirst').val();
            bvmindex.productPrice = parentDom.find('.productPrice').val();
            bvmindex.tagSecond = parentDom.find('.tagSecond').val();
            dataObj = bvmindex;
        } else {
            //新建
            var obj = {};
            obj.name = leftName;
            obj.level = 2;
            obj.formType = 1;
            obj.contentid = contentid;
            obj.parentid = $(dom).parents(".product-switch-set").attr("theid");
            obj.productCode = parentDom.find('.productCode').val();
            obj.productName = parentDom.find('.productName').val();
            obj.orders = parentDom.find('.orders').val();
            obj.startTime = parentDom.find('.dateBegin').val();
            obj.endTime = parentDom.find('.dateEnd').val();
            obj.productPrice = parentDom.find('.productPrice').val();
            obj.timeType = parentDom.find('.timeType:checked').val();
            obj.tagFirst = parentDom.find('.tagFirst').val();
            obj.tagSecond = parentDom.find('.tagSecond').val();
            dataObj = obj
        }
        $.ajax({
            url: baseURL + "contentForm/createOrUpdate",
            type: 'POST',
            dataType: 'json',
            contentType: "application/json;charset=UTF-8",
            data: JSON.stringify(dataObj),
        }).done(function(res) {
            if (res.status == "1") {
                layer.msg("保存成功");
                closeTab(dom);
            } else {
                layer.msg(res.message)
            }
        }).fail(function(res) {
            layer.msg(res.message)
        })
    }
    //商品通栏编辑
    function productSave(dom) {
        var that = $(dom);
        var index = $(dom).attr("index");
        var thisid = $(dom).attr("thisid");
        var parentDom = $(dom).parents(".product-content");
        var leftName = parentDom.parents(".product-set").attr("leftName");
        var bvmindex = productVm.productVmObj[index];
        var dataObj = {};
        if (index && thisid) {
            //有索引和ID代表着更新
            bvmindex.id = thisid;
            bvmindex.name = leftName;
            bvmindex.level = 2;
            bvmindex.contentid = contentid;
            bvmindex.formType = 4;
            bvmindex.parentid = $(dom).parents(".product-set").attr("theid");
            bvmindex.productCode = parentDom.find('.productCode').val();
            bvmindex.productName = parentDom.find('.productName').val();
            bvmindex.orders = parentDom.find('.orders').val();
            bvmindex.startTime = parentDom.find('.dateBegin').val();
            bvmindex.productPrice = parentDom.find('.productPrice').val();
            bvmindex.endTime = parentDom.find('.dateEnd').val();
            bvmindex.timeType = parentDom.find('.timeType:checked').val();
            bvmindex.tagFirst = parentDom.find('.tagFirst').val();
            bvmindex.tagSecond = parentDom.find('.tagSecond').val();
            dataObj = bvmindex;
        } else {
            //新建
            var obj = {};
            obj.name = leftName;
            obj.level = 2;
            obj.formType = 4;
            obj.contentid = contentid;
            obj.parentid = $(dom).parents(".product-set").attr("theid");
            obj.productCode = parentDom.find('.productCode').val();
            obj.productName = parentDom.find('.productName').val();
            obj.orders = parentDom.find('.orders').val();
            obj.startTime = parentDom.find('.dateBegin').val();
            obj.productPrice = parentDom.find('.productPrice').val();
            obj.endTime = parentDom.find('.dateEnd').val();
            obj.timeType = parentDom.find('.timeType:checked').val();
            obj.tagFirst = parentDom.find('.tagFirst').val();
            obj.tagSecond = parentDom.find('.tagSecond').val();
            dataObj = obj
        }
        $.ajax({
            url: baseURL + "contentForm/createOrUpdate",
            type: 'POST',
            dataType: 'json',
            contentType: "application/json;charset=UTF-8",
            data: JSON.stringify(dataObj),
        }).done(function(res) {
            if (res.status == "1") {
                layer.msg("保存成功");
                closeTab(dom);
            } else {
                layer.msg(res.message)
            }
        }).fail(function(res) {
            layer.msg(res.message)
        })
    }
    //分割线编辑
    function borderSave(dom) {
        var theid = $(dom).parents(".border-set").attr("theid");
        var px = $(dom).parents(".border-set").find(".border-px").val();
        var data = {
            "id": theid,
            "name": "分割线",
            "width": px,
            "formType":2,
            "level": 2
        };
        $.ajax({
            url: baseURL + "contentForm/createOrUpdate",
            type: 'POST',
            dataType: 'json',
            contentType: "application/json;charset=UTF-8",
            data: JSON.stringify(data),
        }).done(function(res) {
            if (res.status == "1") {
                layer.msg("保存成功");
                $(".ul2-li").each(function(index, elem) {
                    if ($(elem).attr("theid") == res.data.id) {
                        $(elem).find(".border-set-li").attr("widthpx", res.data.width);
                    }
                })
                closeTab(dom);
            } else {
                layer.msg(res.message)
            }
        }).fail(function() {
            console.log("error");
        })
    }
    //广告长图保存
    function advertisementSave(dom) {
        var bvmindex = advertisementVm.advertisementVmObj;
        var parentDom = $(dom).parents(".advertisement-set");
        var leftName = parentDom.attr("leftName");
        var thisid = parentDom.attr("theid");
        bvmindex.id = thisid;
        bvmindex.name = leftName;
        bvmindex.level = 2;
        bvmindex.formType = 3;
        bvmindex.contentid = contentid;
        bvmindex.imgurl = parentDom.find('.img-hidden').val();
        bvmindex.productCode = parentDom.find('.productCode').val();
        bvmindex.productName = parentDom.find('.productName').val();
        bvmindex.startTime = parentDom.find('.dateBegin').val();
        bvmindex.endTime = parentDom.find('.dateEnd').val();
        bvmindex.timeType = parentDom.find('.timeType:checked').val();
        bvmindex.jumpType = parentDom.find('.bannerurlType:checked').val();
        bvmindex.jumpUrl = parentDom.find('.jumpUrl').val();
        var dataObj = bvmindex;
        $.ajax({
            url: baseURL + "contentForm/createOrUpdate",
            type: 'POST',
            dataType: 'json',
            contentType: "application/json;charset=UTF-8",
            data: JSON.stringify(dataObj),
        }).done(function(res) {
            if (res.status == "1") {
                layer.msg("保存成功");
                closeTab(dom);
            } else {
                layer.msg(res.message)
            }
        }).fail(function(res) {
            layer.msg(res.message)
        })
    }
    // 关闭当前tab设置
    function closeTab(dom) {
        var theid = $(dom).parents(".peizhi").attr("theid");
        $(".ul2-li").each(function(index, el) {
            if (theid == $(el).attr("theid")) {
                $(el).addClass('no-after');
            }
        });
        $(dom).parents(".peizhi").hide();
    }

    function dateInit() {
        $(".dateBegin").each(function(index, elem) {
            laydate.render({
                elem: elem,
                type: 'datetime',
                done: function(value, date, endDate) {

                }
            });
        })
        $(".dateEnd").each(function(index, elem) {
            laydate.render({
                elem: elem,
                type: 'datetime',
                done: function(value, date, endDate) {

                }
            });
        })
    }
    //按钮重新排序
    function btnSort() {
        $(".ul2-li-no-first").each(function(index, ele) {
            var theid = $(ele).attr("theid");
            var thetype = $(ele).attr("thetype");
            var className = "",data="";
            $(".ul2-btn-ul li").each(function(index2, ele2) {
                if (index == index2) {
                    if(thetype == "0") {
                        className = 'banner-set';
                        data = "Banner";
                    }
                    if (thetype == "1") {
                        className = 'product-switch-set';
                        data = "商品滑动栏";
                    }
                    if (thetype == "2") {
                        className = 'border-set';
                        data = "分割线";
                    }
                    if (thetype == "3") {
                        className = 'advertisement-set';
                        data = "广告长图";
                    }
                    if (thetype == "4") {
                        className = 'product-set';
                        data = "商品通栏";
                    }
                    $(ele2).attr({ "theid": theid, "thetype": thetype,"className":className,"dataName":data});
                    $(ele2).find("text").attr({ "theid": theid, "thetype": thetype ,"className":className,"dataName":data});
                }
            })
        })
    }
    </script>
</body>

</html>